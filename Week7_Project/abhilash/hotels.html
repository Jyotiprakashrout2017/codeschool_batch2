<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

    <title> Login Page </title>
    <link rel="stylesheet" type="text/css" href="admin.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <header>
        <div class="container-fluid  p-0">
            <div class="row">
                <div class=" col-lg-12 col-sm-12 p-0 m-0">
                    <div class="d-flex flex-row  bg-dark head">
                        <div class="d-flex justify-content-start align-items-center mx-5 ">
                            <div>
                                <h3 class="text-white">ùêÄùêáùê®ùê≠ùêûùê•ùê¨.ùêúùê®ùê¶</h3>
                            </div>
                        </div>
                        <div class=" d-flex  ms-auto p-2 align-items-center mx-5">
                            <div><button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="admin.html" class=" text-white ">Home</a></h5>
                                </button>
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="hotels.html" class=" text-white">Hotels</a></h5>
                                </button>
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="About.html" class=" text-white">About</a></h5>
                                </button>
                                <!-- <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="user_bookings.html" class=" text-white" id="bookings">Bookings</a></h5>
                                </button> -->
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="login.html" class=" text-white" id="logoutbutton">Logout</a>
                                    </h5>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header close -->
    <div class="container p-5">
        <div class="row">
            <button type="button" class="btn btn-dark text-white button" data-bs-toggle="modal" data-bs-target="#model">
                Add Hotels
            </button>

            <!-- Modal For Add hotel -->
            <div class="modal fade " id="model" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                aria-labelledby="model" aria-hidden="true">
                <div class="modal-dialog dialog">
                    <div class="modal-content content">
                        <div class="modal-header header">
                            <h5 class="modal-title" class=" h5 text-white" id="model">Adding Hotels</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body " style="height:200px;">
                            <div class="row">

                                <label class="col-sm-3 pt-2 h5" for="HotelnameInput"> Hotel Name</label>
                                <input class=" form-control" type="text" id="HotelnameInput"
                                    placeholder="Enter Hotel Name" />


                                <label class="col-sm-3 pt-2 h5" for="HoteltypeInput"> Hotel Type </label>
                                <select input="text" class="int2 form-control pt-2" id="HoteltypeInput"
                                    placeholder="Enter Hotel Name">

                                    <option value="1">1Star</option>
                                    <option value="2">2Star </option>
                                    <option value="3">3Star</option>
                                    <option value="4">4Star</option>
                                    <option value="5">5Star-</option>
                                </select>+


                            </div>
                        </div><br>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="Update">ADD</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>


    </div>

    
        <!-- Modal For edit hotel -->
        <div class="container">
            <div>
                <div class="modal fade " id="edit" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                    aria-labelledby="model" aria-hidden="true">
                    <div class="modal-dialog dialog">
                        <div class="modal-content content">
                            <div class="modal-header header">
                                <h5 class="modal-title" class=" h5 text-white" id="edit">Editing Hotels</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body " style="height:200px;">
                                <div class="row">

                                    <label class="col-sm-3 pt-2 h5" for="HotelnameInput1"> Hotel Name</label>
                                    <input class=" form-control" type="text" id="HotelnameInput1"
                                        placeholder="Enter Hotel Name" />


                                    <label class="col-sm-3 pt-2 h5" for="HoteltypeInput1"> Hotel Type </label>
                                    <select input="text" class="int2 form-control pt-2" id="HoteltypeInput1"
                                        placeholder="Enter Hotel Name">

                                    <option value=1>1Star</option>
                                    <option value=2>2Star </option>
                                    <option value=3>3Star</option>
                                    <option value=4>4Star</option>
                                    <option value=5>5Star</option>
                                    </select>

                                </div>
                            </div><br>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" id="updatehotels">Update</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
         <!-- End of edit hotel -->

    <div class="login-form-container my-5">
        <h1 class="heading">List Of Hotels</h1>
        <div class="table1">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Hotel Id</th>
                        <th scope="col">Name</th>
                        <th scope="col">Hotel Type</th>

                    </tr>
                </thead>
                <tbody id="hotels">

                </tbody>
            </table>
        </div>
</body>
<script>
    // ajax hotel details//
    $.ajax({
        type: "POST",
        url: "hotel.php",
        // data:formData,
        dataType: 'JSON',
        success: function (data) {
            //    data=JSON.parse(data);
            console.log(data)
            if (data.status) {
                console.log(data)
                for (let i = 0; i < data.output.length; i++) {
                    $('#hotels').append(` 
                    <tr>
                      <td>${data.output[i].hotel_id}</td>
                      <td>${data.output[i].name}</td>
                      <td>${data.output[i].hotel_type}</td>
                      <td><a href="roomsdetails.html?id=${data.output[i].hotel_id}"><button type="button" class="btn btn-success "
                  >Room Details</button></a></td>
                  <td><button type="button" class="btn btn-success"style="width:100%"  data-bs-toggle="modal" data-bs-target="#edit" 
                  onclick="Edithotel(${data.output[i].hotel_id})">Edit</button> </td>
                  <td><button type="button" class="btn btn-success"style="width:100%" 
                  onclick="deletehotel(${data.output[i].hotel_id})">Delete</button> </td>
                      </tr>              

                      `)

                }

            }

        }
    })

    // AJAX FOR ADDING HOTELS 
    $('#Update').click(function () {
        var formdata = {
            hotel_name: $('#HotelnameInput').val(),
            hotel_type: $('#HoteltypeInput').val()
        }
        $.ajax({
            type: 'POST',
            url: 'inserthotel.php',
            data: formdata,
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }

            }
        })
    });
    // AJAX FOR EDIT HOTELS 
    function Edithotel(hotelId) {
        $.ajax({
            type: 'POST',
            url: 'hotel.php',
            data: { id: hotelId },
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                res = res.output[0];    
                $('#HotelnameInput1').val(res.name);
                $('#HoteltypeInput1').val(res.hotel_type);
                localStorage.setItem('hoteldetails',JSON.stringify(res.hotel_id));
            }
        })
    }
    
      // AJAX FOR DELETE HOTELS 
      function deletehotel(hotelId) {
        $.ajax({
            type: 'POST',
            url: 'deletehotel.php',
            data: { id: hotelId },
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                // res = res.output[0];    
                // $('#HotelnameInput1').val(res.name);
                // $('#HoteltypeInput1').val(res.hotel_type);
                // localStorage.setItem('hoteldetails',JSON.stringify(res.hotel_id));
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }
            }
        })
    }

    // AJAX FOR UPDATE HOTELS 
    let hotelDetails=localStorage.getItem('hoteldetails');
    hotel_Id=JSON.parse(hotelDetails)
    console.log(hotel_Id)

    $('#updatehotels').click(function () {
        var formdata = {
            hotel_name: $('#HotelnameInput1').val(),
            hotel_type: $('#HoteltypeInput1').val(),
            hotel_id:hotel_Id
        }
        console.log(formdata)
        $.ajax({
            type: 'POST',
            url: 'updatehotels.php',
            data: formdata,
          
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }

            }

        })
    });

</script>

</html>