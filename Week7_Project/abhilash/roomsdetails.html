<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

    <title> Login Page </title>
    <link rel="stylesheet" type="text/css" href="admin.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <header>
        <div class="container-fluid  p-0">
            <div class="row">
                <div class=" col-lg-12 col-sm-12 p-0 m-0">
                    <div class="d-flex flex-row  bg-dark head">
                        <div class="d-flex justify-content-start align-items-center mx-5 ">
                            <div>
                                <h3 class="text-white">ùêÄùêáùê®ùê≠ùêûùê•ùê¨.ùêúùê®ùê¶</h3>
                            </div>
                        </div>
                        <div class=" d-flex  ms-auto p-2 align-items-center mx-5">
                            <div><button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="admin.html" class=" text-white ">Home</a></h5>
                                </button>
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="hotels.html" class=" text-white">Hotels</a></h5>
                                </button>
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="About.html" class=" text-white">About</a></h5>
                                </button>
                                <!-- <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="user_bookings.html" class=" text-white" id="bookings">Bookings</a></h5>
                                </button> -->
                                <button class="btn btn-dark text-white">
                                    <h5 class="h5"><a href="login.html" class=" text-white" id="logoutbutton">Logout</a>
                                    </h5>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container p-5">
        <div class="row">
            <button type="button" class="btn btn-dark text-white button" data-bs-toggle="modal" data-bs-target="#model">
                Add Rooms
            </button>

            <!-- Modal For Add room -->
            <div class="modal fade " id="model" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                aria-labelledby="model" aria-hidden="true">
                <div class="modal-dialog dialog">
                    <div class="modal-content content">
                        <div class="modal-header header">
                            <h5 class="modal-title" class=" h5 text-white" id="model">Adding Rooms</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body " style="height:200px;">
                            <div class="row">

                                <label class="col-sm-3 pt-2 h5" for="roomnumberInput"> Room Number</label>
                                <input class=" form-control" type="text" id="roomnumberInput"
                                    placeholder="Enter Room No" />


                                <label class="col-sm-3 pt-2 h5" for="roomcategeryInput"> Room Categery </label>
                                <select input="text" class="int2 form-control pt-2" id="roomcategeryInput"
                                    placeholder="Select Room Categery">

                                    <option value="1">STANDARD ROOM</option>
                                    <option value="2">FAMILY ROOM</option>
                                    <option value="3">DELUXE ROOM</option>
                                    <option value="4">LUXURY ROOM</option>
                                </select>

                            </div>
                        </div><br>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="Update">ADD</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>


    </div>
    <!-- Modal For edit hotel -->
    <div class="container">
        <div>
            <div class="modal fade " id="edit" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                aria-labelledby="model" aria-hidden="true">
                <div class="modal-dialog dialog">
                    <div class="modal-content content">
                        <div class="modal-header header">
                            <h5 class="modal-title" class=" h5 text-white" id="edit">Editing Rooms</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body " style="height:200px;">
                            <div class="row">

                                <label class="col-sm-3 pt-2 h5" for="roomnumberInput1"> Room Number</label>
                                <input class=" form-control" type="text" id="roomnumberInput1"
                                    placeholder="Enter Room No" />


                                <label class="col-sm-3 pt-2 h5" for="roomcategeryInput1"> Room_Categery</label>
                                <select input="text" class="int2 form-control pt-2" id="roomcategeryInput1"
                                    placeholder="Select Room Categery">

                                <option value=1>STANDARD ROOM</option>
                                <option value=2>FAMILY ROOM </option>
                                <option value=3>DELUXE ROOM</option>
                                <option value=4>LUXURY ROOM</option>
                                </select>

                            </div>
                        </div><br>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="updaterooms">Update</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>
     <!-- End of edit rooms -->
    <!-- header close -->
    <div class="login-form-container">
        <h1 class="heading">Room Details</h1>
        <div class="table1">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Room Id</th>
                        <th scope="col">Room number</th>
                        <th scope="col">Room Categery</th>
                    </tr>
                </thead>
                <tbody id="roomdetails">

                </tbody>
            </table>
        </div>
        <button class="btn btn-dark text-white">
            <h5 class="h5"><a class=" text-white" id="logoutbutton">Logout</a>
            </h5>
        </button>
    </div>

</body>
<script>
    var params = new URLSearchParams(window.location.search);
    $.ajax({
        type: "GET",
        url: "roomsdetails.php",
        data: {
            'id': params.get('id'),
        },
        success: function (res, status, xhr) {
            let response = JSON.parse(res);
            if (response.status) {
                for (let i = 0; i < response.output.length; i++) {
                    $('#roomdetails').append(`
                <tr>
                            <td>${response.output[i].room_id}</td>
                            <td>${response.output[i].room_no}</td>
                            <td>${response.output[i].room_categery}</td>
                            <td><button type="button"class="btn btn-success"style="width:100%" data-bs-toggle="modal" data-bs-target="#edit"
                  onclick="Edirooms(${response.output[i].room_id})">Edit</button></td> 
                  <td><button type="button"class="btn btn-success"style="width:100%" 
                  onclick="deleterooms(${response.output[i].room_id})">Delete</button></td>     
                </tr>
                `)
                }
            }
        }
    })
// AJAX FOR ADDING Rooms 
$('#Update').click(function () {
        var formdata = {
            room_number: $('#roomnumberInput').val(),
            room_categery: $('#roomcategeryInput').val(),
            'id': params.get('id'),
        }
        $.ajax({
            type: 'POST',
            url: 'insertroom.php',
            data: formdata,
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }

            }
        })
    });
 // AJAX FOR EDIT ROOMS 
    function Edirooms(roomId) {
        console.log(roomId)
        $.ajax({
            type: 'POST',
            url: 'roomsdetails.php',
            data: { id: roomId },
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                res = res.output[0];    
                $('#roomnumberInput1').val(res.room_no);
                $('#roomcategeryInput1').val(res.room_categery);
                localStorage.setItem('RoomDetails',JSON.stringify(res.room_id));
            }
        })
    }
// AJAX FOR UPDATE HOTELS 
let roomdetails=localStorage.getItem('RoomDetails');
    room_Id=JSON.parse(roomdetails)
    console.log(room_Id)

    $('#updaterooms').click(function () {
        var formdata = {
            room_no: $('#roomnumberInput1').val(),
            room_categery: $('#roomcategeryInput1').val(),
            room_id:room_Id
        }
        console.log(formdata)
        $.ajax({
            type: 'POST',
            url: 'Updaterooms.php',
            data: formdata,
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }

            }

        })
    });

 // AJAX FOR DELETE HOTELS 
 function deleterooms(roomId) {
        $.ajax({
            type: 'POST',
            url: 'deleteroom.php',
            data: { id: roomId },
            success: function (response, status, xhr) {
                let res = JSON.parse(response);
                if (!res.status) {
                    $('#errors').text(res.message);

                } else{
                    alert(res.message);
                    window.location.reload();
                }
            }
        })
    }

</script>



</html>